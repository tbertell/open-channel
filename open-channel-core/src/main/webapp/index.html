<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>OpenChannel UI</title>

<link rel="stylesheet"
	href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script
	src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>

</head>
<body>

	<!-- Container page -->
	<div data-role="page" data-theme="b" id="containerPage">
		<div data-role="header" id="hdrChannelTypes" data-nobackbtn="true">
			<h1>Channel type list</h1>
		</div>

		<div data-role="content" id="contentChannelTypes">
			<ul data-role="listview" data-split-icon="arrow-r"
				data-split-theme="d" id="channelDetails"></ul>
		</div>

		<div data-role="footer" id="ftrChannelTypes"></div>
	</div>

	<!-- StockQuoteChannel -->
	<div data-role="header" id="hdrStockQuoteChannel" data-nobackbtn="true">
		<h1>StockQuoteChannel</h1>
		<a id="buttonHdrShowChannelTypes" data-icon="arrow-l"
			class="ui-btn-left" href="" data-role="button" data-inline="true">Back</a>
	</div>

	<div data-role="content" id="contentStockQuoteChannel"></div>

	<div data-role="footer" id="ftrDetails">
		<a id="buttonUpdate" data-icon="arrow-r" class="ui-btn-right" href=""
			data-role="button" data-inline="true">Update</a>
	</div>

	<!-- TimerLogChannel -->
	<div data-role="header" id="hdrDetails" data-nobackbtn="true">
		<h1>TimerLogChannel</h1>
		<a id="buttonHdrShowChannelTypes" data-icon="arrow-l"
			class="ui-btn-left" href="" data-role="button" data-inline="true">Back</a>
	</div>

	<div data-role="content" id="contentTimerLogChannel"></div>

	<div data-role="footer" id="ftrDetails">
		<a id="buttonUpdate" data-icon="arrow-r" class="ui-btn-right" href=""
			data-role="button" data-inline="true">Update</a>
	</div>

	<!-- Progress -->
	<div data-role="header" id="hdrProgress" data-nobackbtn="true">
		<h1>Processing...</h1>
	</div>
	<div data-role="content" id="contentProgress">
		<div align="CENTER">
			<h4>Please wait.</h4>
		</div>
		<div align="CENTER">
			<img id="spin" src="img/wait.gif" />
		</div>
	</div>
	<div data-role="footer" id="ftrProgress"></div>
	<script>
    
	var rootURL = 'http://localhost:8080/channels/';
	
	$(document).ready(function () {  
	  showProgress();  
	  findAll(createList);	
	});
	   
	function createList(xml) {  
		var HTML_FRG1 = '<li id="';  
		var HTML_FRG2 = '"><h3><a id="';  
		var HTML_FRG3 = '"  href="#">';  
		var HTML_FRG4 = '</a></h3><p id="';  
		var HTML_FRG5 = '"></p><a href="#" data-transition="slideup" id="';  
		var HTML_FRG6 = '"/></li>';
		
		var channelDetailsVar = $('#channelDetails'); 
		
		$(xml).find("channel").each(function() {
			var id = $(this).find("id").text();
			var description = $(this).find("description").text();
			var link = $(this).find("link").attr("href");
			
			$(HTML_FRG1 + id +'_li' + HTML_FRG2 + id +'_h' + HTML_FRG3 + id + HTML_FRG4 + description + HTML_FRG5 +  
				id +'_a' + HTML_FRG6).prependTo(channelDetailsVar); 
		});
	}  

	
	function findAll(handler) {
	    $.ajax({
	        type: 'GET',
	        url: rootURL,
	        dataType: "application/xml",
	        headers: {"Authorization": make_base_auth('test', 'test1')},
	        success: handler
	    });
	    return false;
	}
	
	function make_base_auth(user, password) {
	  var tok = user + ':' + password;
	  var hash = btoa(tok);
	  return "Basic " + hash;
	}
	
	
	var hdrChannelTypesVar = $('#hdrChannelTypes');
	var contentChannelTypesVar = $('#contentChannelTypes');
	var ftrChannelTypesVar = $('#ftrChannelTypes');
	
	var hdrStockQuoteChannelVar = $('#hdrStockQuoteChannel');
	var contentStockQuoteChannelVar = $('#contentStockQuoteChannel');
	var ftrStockQuoteChannelVar = $('#ftrStockQuoteChannel');
	
	var hdrTimerLogChannelVar = $('#hdrTimerLogChannel');
	var contentTimerLogChannelVar = $('#contentTimerLogChannel');
	var ftrTimerLogChannelVar = $('#ftrTimerLogChannel');
	
	var hdrProgressVar = $('#hdrProgress');
	var contentProgressVar = $('#contentProgress');
	var ftrProgressVar = $('#ftrProgress');
	
	function hideChannelTypes() {
		hdrChannelTypesVar.hide();
		contentChannelTypesVar.hide();
		ftrChannelTypesVar.hide();      
	}
	
	function showChannelTypes() {
		hideStockQuoteChannel();
		hideTimerLogChannel();
	  hideProgress();
	  hdrChannelTypesVar.show();
		contentChannelTypesVar.show();
		ftrChannelTypesVar.show();
	}
	
	function hideStockQuoteChannel() {
		hdrStockQuoteChannelVar.hide();
		contentStockQuoteChannelVar.hide();
		ftrStockQuoteChannelVar.hide();      
	}
	
	function showStockQuoteChannel() {
		hideChannelTypes();
		hideTimerLogChannel();
	  hideProgress();
	  hdrStockQuoteChannelVar.show();
		contentStockQuoteChannelVar.show();
		ftrStockQuoteChannelVar.show();     
	}
	
	function hideTimerLogChannel() {
		hdrTimerLogChannelVar.hide();
		contentTimerLogChannelVar.hide();
		ftrTimerLogChannelVar.hide();      
	}
	
	function showTimerLogChannel() {
		hideChannelTypes();
		showStockQuoteChannel();
	  hideProgress();
		hdrTimerLogChannelVar.show();
		contentTimerLogChannelVar.show();
		ftrTimerLogChannelVar.show(); 
	}
	 
	function showProgress() {
		hideChannelTypes();
	  hideStockQuoteChannel();
	  hideTimerLogChannel();
	  hdrProgressVar.show();
	  contentProgressVar.show();
	  ftrProgressVar.show();
	}
	
	function hideProgress() {
		hdrProgressVar.hide();
		contentProgressVar.hide();
		ftrProgressVar.hide();
	}   
    </script>
</body>
</html>